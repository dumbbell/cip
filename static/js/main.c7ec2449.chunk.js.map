{"version":3,"sources":["components/Album.js","App.js","reportWebVitals.js","index.js"],"names":["clubImmoAddress","Copyright","Typography","variant","color","align","Link","href","Date","getFullYear","theme","createTheme","Album","web3React","useWeb3React","useState","studentAddress","setStudentAddress","privileges","setPrivilegesList","privilegesBaseURL","URL","window","location","requestAccount","a","ethereum","request","method","provider","ethers","providers","Web3Provider","signer","getSigner","contract","Contract","ClubImmoPrivilege","abi","URIs","url","console","log","push","address","utils","getAddress","grantPrivileges","transaction","wait","fetchPrivileges","activate","account","balanceOf","balance","toString","array","i","tokenOfOwnerByIndex","privilegeId","tokenURI","privilegeUri","fetch","response","json","id","useEffect","updatePrivileges","ThemeProvider","CssBaseline","AppBar","position","Toolbar","sx","mr","noWrap","Box","bgcolor","pt","pb","Container","maxWidth","component","gutterBottom","paragraph","Stack","direction","spacing","justifyContent","Button","onClick","py","Grid","container","map","privilege","item","xs","sm","md","Card","height","display","flexDirection","CardMedia","image","alt","name","CardContent","flexGrow","description","CardActions","size","p","TextField","required","label","defaultValue","onChange","e","target","value","getLibrary","connector","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c7ec2449.chunk.js","sourcesContent":["import * as React from 'react';\nimport AppBar from '@mui/material/AppBar';\nimport Button from '@mui/material/Button';\nimport LocationCity from '@mui/icons-material/LocationCity';\nimport Card from '@mui/material/Card';\nimport CardActions from '@mui/material/CardActions';\nimport CardContent from '@mui/material/CardContent';\nimport CardMedia from '@mui/material/CardMedia';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport Grid from '@mui/material/Grid';\nimport Stack from '@mui/material/Stack';\nimport TextField from '@mui/material/TextField';\nimport Box from '@mui/material/Box';\nimport Toolbar from '@mui/material/Toolbar';\nimport Typography from '@mui/material/Typography';\nimport Container from '@mui/material/Container';\nimport Link from '@mui/material/Link';\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\n\nimport { ethers } from 'ethers';\nimport { useWeb3React } from '@web3-react/core';\nimport { useState, useEffect } from 'react';\nimport ClubImmoPrivilege from '../artifacts/contracts/ClubImmoPrivilege.sol/ClubImmoPrivilege.json'\n\n//const clubImmoAddress = \"0xc5a5C42992dECbae36851359345FE25997F5C42d\"; // Localhost\nconst clubImmoAddress = \"0xe14e8AF51183483c630dd39998B17ea1CbbB244f\"; // Ropsten\n\nfunction Copyright() {\n  return (\n    <Typography variant=\"body2\" color=\"text.secondary\" align=\"center\">\n      {'Copyright © '}\n      <Link color=\"inherit\" href=\"https://mui.com/\">\n        Jean-Sébastien Pédron\n      </Link>{' '}\n      {new Date().getFullYear()}\n      {'.'}\n    </Typography>\n  );\n}\n\nconst theme = createTheme();\n\nexport default function Album() {\n  const web3React = useWeb3React();\n  const [studentAddress, setStudentAddress] = useState();\n  const [privileges, setPrivilegesList] = useState([]);\n  const privilegesBaseURL = new URL('privileges/', window.location.href);\n  console.log(privilegesBaseURL);\n\n  // request access to the user's MetaMask account\n  async function requestAccount() {\n    await window.ethereum.request({ method: 'eth_requestAccounts' });\n  }\n\n  async function grantPrivileges() {\n    if (!studentAddress) return;\n\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount();\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(clubImmoAddress, ClubImmoPrivilege.abi, signer);\n\n      const paths = [\n        'creation-sci.json',\n        'creation-holding.json',\n        'coaching.json',\n        'workshop.json',\n      ];\n      const URIs = [];\n      for (var path of paths) {\n        var url = new URL(path, privilegesBaseURL);\n        console.log(url.href);\n        URIs.push(url.href);\n      }\n\n      const address = ethers.utils.getAddress(studentAddress);\n      const transaction = await contract.grantPrivileges(address, URIs);\n      await transaction.wait();\n      fetchPrivileges();\n    }\n  }\n\n  async function fetchPrivileges() {\n    await web3React.activate();\n\n    if (typeof window.ethereum !== 'undefined') {\n      const [account] = await window.ethereum.request({ method: 'eth_requestAccounts' });\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const contract = new ethers.Contract(\n        clubImmoAddress, ClubImmoPrivilege.abi, provider);\n\n      try {\n        const balance = await contract.balanceOf(account);\n        console.log('Privileges count:', balance.toString())\n\n        let array = [];\n        for (var i = 0; i < balance; i++) {\n          const privilegeId = await contract.tokenOfOwnerByIndex(account, i);\n          const privilegeUri = await contract.tokenURI(privilegeId);\n          console.log('Privilege URI:', privilegeUri);\n\n          const response = await fetch(privilegeUri);\n          const json = await response.json();\n          json.id = privilegeId;\n          console.log('Privilege JSON:', json);\n          array.push(json);\n        }\n        console.log('Privileges: ', array)\n        setPrivilegesList(array);\n      } catch (err) {\n        console.log(\"Error:\", err)\n      }\n    }\n  }\n\n  useEffect(() => {\n    async function updatePrivileges() {\n      await fetchPrivileges();\n    }\n    updatePrivileges()\n  }, []);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <LocationCity sx={{ mr: 2 }} />\n          <Typography variant=\"h6\" color=\"inherit\" noWrap>\n            Mes privilèges Club Immobilier\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <main>\n        {/* Hero unit */}\n        <Box\n          sx={{\n            bgcolor: 'background.paper',\n            pt: 8,\n            pb: 6,\n          }}\n        >\n          <Container maxWidth=\"sm\">\n            <Typography\n              component=\"h1\"\n              variant=\"h2\"\n              align=\"center\"\n              color=\"text.primary\"\n              gutterBottom\n            >\n              Mes privilèges Club&nbsp;Immobilier\n            </Typography>\n            <Typography variant=\"h5\" align=\"center\" color=\"text.secondary\" paragraph>\n              Voici la liste des privilèges Club Immobilier en votre\n              possession. Libre à vous de vous en servir ou de les échanger\n              avec les autres élèves Club Immobilier grâce à la <em>blockchain\n              Ethereum</em>.\n            </Typography>\n            <Stack\n              sx={{ pt: 4 }}\n              direction=\"row\"\n              spacing={2}\n              justifyContent=\"center\"\n            >\n              <Button\n                align=\"center\"\n                onClick={fetchPrivileges}\n              >\n                Récupérer mes privilèges\n              </Button>\n            </Stack>\n          </Container>\n        </Box>\n        <Container sx={{ py: 8 }} maxWidth=\"md\">\n          {/* End hero unit */}\n          <Grid container spacing={4}>\n            {privileges.map((privilege) => (\n              <Grid item key={privilege.id} xs={12} sm={6} md={4}>\n                <Card\n                  sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}\n                >\n                  <CardMedia\n                    component=\"img\"\n                    image={new URL(privilege.image, privilegesBaseURL).href}\n                    alt={privilege.name}\n                  />\n                  <CardContent sx={{ flexGrow: 1 }}>\n                    <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                      {privilege.name}\n                    </Typography>\n                    <Typography>\n                      {privilege.description}\n                    </Typography>\n                  </CardContent>\n                  <CardActions>\n                    <Button size=\"small\">Transférer</Button>\n                  </CardActions>\n                </Card>\n              </Grid>\n            ))}\n          </Grid>\n        </Container>\n      </main>\n      {/* Footer */}\n      <Box sx={{ bgcolor: 'background.paper', p: 6 }} component=\"footer\">\n        <Typography variant=\"h6\" align=\"center\" gutterBottom>\n          Mes privilèges Club Immobilier\n        </Typography>\n        <Typography\n          variant=\"subtitle1\"\n          align=\"center\"\n          color=\"text.secondary\"\n          component=\"p\"\n        >\n          Un outil qu'il est bien pour s'initier à la blockchain !\n        </Typography>\n        <Stack\n          direction=\"row\"\n          spacing={2}\n          justifyContent=\"center\"\n        >\n          <TextField\n            required\n            id=\"standard-required\"\n            label=\"Adresse Ethereum de l'étudiant\"\n            defaultValue=\"\"\n            variant=\"standard\"\n            onChange={e => setStudentAddress(e.target.value)}\n          />\n          <Button\n            align=\"center\"\n            onClick={grantPrivileges}\n          >\n            Attribuer les privilèges\n          </Button>\n        </Stack>\n        <Copyright />\n      </Box>\n      {/* End footer */}\n    </ThemeProvider>\n  );\n}\n","import './App.css';\n\nimport { ethers } from 'ethers';\nimport { Web3ReactProvider } from '@web3-react/core'\nimport Album from './components/Album.js';\n\nfunction getLibrary(provider, connector) {\n  return new ethers.provider.Web3Provider(provider);\n}\n\nfunction App() {\n  return (\n    <Web3ReactProvider getLibrary={getLibrary}>\n      <Album/>\n    </Web3ReactProvider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}